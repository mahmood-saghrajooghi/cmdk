import{a as ce}from"./chunk-NZJY6EH4.mjs";import*as w from"@radix-ui/react-dialog";import*as r from"react";import{Primitive as I}from"@radix-ui/react-primitive";var V='[cmdk-group=""]',W='[cmdk-group-items=""]',pe='[cmdk-group-heading=""]',X='[cmdk-item=""]',le=`${X}:not([aria-disabled="true"])`,J="cmdk-item-select",T="data-value",Re=(t,o,n)=>ce(t,o,n),ue=r.createContext(void 0),G=()=>r.useContext(ue),de=r.createContext(void 0),Q=()=>r.useContext(de),fe=r.createContext(void 0);function be(t,o){let[n,l]=r.useState(o);return r.useEffect(()=>(l(o()),t(()=>{l(o())})),[t,o]),n}var me=r.forwardRef((t,o)=>{let n=L(()=>{var e,s;return{search:"",value:(s=(e=t.value)!=null?e:t.defaultValue)!=null?s:"",filtered:{count:0,items:new Map,groups:new Set}}}),l=L(()=>new Set),c=L(()=>new Map),f=L(()=>new Map),d=L(()=>new Set),v=ve(t),{label:g,children:b,value:u,onValueChange:y,filter:E,shouldFilter:C,loop:H,disablePointerSelection:Y=!1,listId:Z,inputId:ee,labelId:te,vimBindings:K=!0,...M}=t,x=r.useRef(null),R=Te();k(()=>{if(u!==void 0){let e=u.trim();n.current.value=e,h.emit()}},[u]),k(()=>{R(6,re)},[]);let h=r.useMemo(()=>({subscribe:e=>(d.current.add(e),()=>d.current.delete(e)),snapshot:()=>n.current,setState:(e,s,i)=>{var a,m,p;if(!Object.is(n.current[e],s)){if(n.current[e]=s,e==="search")q(),j(),R(1,B);else if(e==="value"&&(i||R(5,re),((a=v.current)==null?void 0:a.value)!==void 0)){let S=s!=null?s:"";(p=(m=v.current).onValueChange)==null||p.call(m,S);return}h.emit()}},emit:()=>{d.current.forEach(e=>e())}}),[]),$=r.useMemo(()=>({value:(e,s,i)=>{var a;s!==((a=f.current.get(e))==null?void 0:a.value)&&(f.current.set(e,{value:s,keywords:i}),n.current.filtered.items.set(e,ne(s,i)),R(2,()=>{j(),h.emit()}))},item:(e,s)=>(l.current.add(e),s&&(c.current.has(s)?c.current.get(s).add(e):c.current.set(s,new Set([e]))),R(3,()=>{q(),j(),n.current.value||B(),h.emit()}),()=>{f.current.delete(e),l.current.delete(e),n.current.filtered.items.delete(e);let i=O();R(4,()=>{q(),(i==null?void 0:i.getAttribute("id"))===e&&B(),h.emit()})}),group:e=>(c.current.has(e)||c.current.set(e,new Set),()=>{f.current.delete(e),c.current.delete(e)}),filter:()=>v.current.shouldFilter,label:g||t["aria-label"],disablePointerSelection:Y,listId:Z,inputId:ee,labelId:te,listInnerRef:x}),[]);function ne(e,s){var a,m;let i=(m=(a=v.current)==null?void 0:a.filter)!=null?m:Re;return e?i(e,n.current.search,s):0}function j(){if(!n.current.search||v.current.shouldFilter===!1)return;let e=n.current.filtered.items,s=[];n.current.filtered.groups.forEach(a=>{let m=c.current.get(a),p=0;m.forEach(S=>{let P=e.get(S);p=Math.max(P,p)}),s.push([a,p])});let i=x.current;A().sort((a,m)=>{var P,_;let p=a.getAttribute("id"),S=m.getAttribute("id");return((P=e.get(S))!=null?P:0)-((_=e.get(p))!=null?_:0)}).forEach(a=>{let m=a.closest(W);m?m.appendChild(a.parentElement===m?a:a.closest(`${W} > *`)):i.appendChild(a.parentElement===i?a:a.closest(`${W} > *`))}),s.sort((a,m)=>m[1]-a[1]).forEach(a=>{var p;let m=(p=x.current)==null?void 0:p.querySelector(`${V}[${T}="${encodeURIComponent(a[0])}"]`);m==null||m.parentElement.appendChild(m)})}function B(){let e=A().find(i=>i.getAttribute("aria-disabled")!=="true"),s=e==null?void 0:e.getAttribute(T);h.setState("value",s||void 0)}function q(){var s,i,a,m;if(!n.current.search||v.current.shouldFilter===!1){n.current.filtered.count=l.current.size;return}n.current.filtered.groups=new Set;let e=0;for(let p of l.current){let S=(i=(s=f.current.get(p))==null?void 0:s.value)!=null?i:"",P=(m=(a=f.current.get(p))==null?void 0:a.keywords)!=null?m:[],_=ne(S,P);n.current.filtered.items.set(p,_),_>0&&e++}for(let[p,S]of c.current)for(let P of S)if(n.current.filtered.items.get(P)>0){n.current.filtered.groups.add(p);break}n.current.filtered.count=e}function re(){var s,i,a;let e=O();e&&(((s=e.parentElement)==null?void 0:s.firstChild)===e&&((a=(i=e.closest(V))==null?void 0:i.querySelector(pe))==null||a.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function O(){var e;return(e=x.current)==null?void 0:e.querySelector(`${X}[aria-selected="true"]`)}function A(){var e;return Array.from(((e=x.current)==null?void 0:e.querySelectorAll(le))||[])}function U(e){let i=A()[e];i&&h.setState("value",i.getAttribute(T))}function z(e){var p;let s=O(),i=A(),a=i.findIndex(S=>S===s),m=i[a+e];(p=v.current)!=null&&p.loop&&(m=a+e<0?i[i.length-1]:a+e===i.length?i[0]:i[a+e]),m&&h.setState("value",m.getAttribute(T))}function oe(e){let s=O(),i=s==null?void 0:s.closest(V),a;for(;i&&!a;)i=e>0?Ie(i,V):Me(i,V),a=i==null?void 0:i.querySelector(le);a?h.setState("value",a.getAttribute(T)):z(e)}let ie=()=>U(A().length-1),ae=e=>{e.preventDefault(),e.metaKey?ie():e.altKey?oe(1):z(1)},se=e=>{e.preventDefault(),e.metaKey?U(0):e.altKey?oe(-1):z(-1)};return r.createElement(I.div,{ref:o,tabIndex:-1,...M,"cmdk-root":"",onKeyDown:e=>{var s;if((s=M.onKeyDown)==null||s.call(M,e),!e.defaultPrevented)switch(e.key){case"n":case"j":{K&&e.ctrlKey&&ae(e);break}case"ArrowDown":{ae(e);break}case"p":case"k":{K&&e.ctrlKey&&se(e);break}case"ArrowUp":{se(e);break}case"Home":{e.preventDefault(),U(0);break}case"End":{e.preventDefault(),ie();break}case"Enter":if(!e.nativeEvent.isComposing&&e.keyCode!==229){e.preventDefault();let i=O();if(i){let a=new Event(J);i.dispatchEvent(a)}}}}},r.createElement("label",{"cmdk-label":"",htmlFor:$.inputId,id:$.labelId,style:De},g),F(t,e=>r.createElement(de.Provider,{value:h},r.createElement(ue.Provider,{value:$},e))))}),he=r.forwardRef((t,o)=>{var M,x;let n=t.id,l=r.useRef(null),c=r.useContext(fe),f=G(),d=ve(t),v=(x=(M=d.current)==null?void 0:M.forceMount)!=null?x:c==null?void 0:c.forceMount;k(()=>{if(!v)return f.item(n,c==null?void 0:c.id)},[v]);let g=ge(n,l,[t.value,t.children,l],t.keywords),b=Q(),u=D(R=>R.value&&R.value===g.current),y=D(R=>v||f.filter()===!1?!0:R.search?R.filtered.items.get(n)>0:!0);r.useEffect(()=>{let R=l.current;if(!(!R||t.disabled))return R.addEventListener(J,E),()=>R.removeEventListener(J,E)},[y,t.onSelect,t.disabled]);function E(){var R,h;C(),(h=(R=d.current).onSelect)==null||h.call(R,g.current)}function C(){b.setState("value",g.current,!0)}if(!y)return null;let{disabled:H,value:Y,onSelect:Z,forceMount:ee,keywords:te,...K}=t;return r.createElement(I.div,{ref:N([l,o]),...K,id:n,"cmdk-item":"",role:"option","aria-disabled":!!H,"aria-selected":!!u,"data-disabled":!!H,"data-selected":!!u,onPointerMove:H||f.disablePointerSelection?void 0:C,onClick:H?void 0:E},t.children)}),ye=r.forwardRef((t,o)=>{let{heading:n,children:l,forceMount:c,...f}=t,d=t.id,v=r.useRef(null),g=r.useRef(null),b=`cmdk-heading-${d}`,u=G(),y=D(C=>c||u.filter()===!1?!0:C.search?C.filtered.groups.has(d):!0);k(()=>u.group(d),[]),ge(d,v,[t.value,t.heading,g]);let E=r.useMemo(()=>({id:d,forceMount:c}),[c]);return r.createElement(I.div,{ref:N([v,o]),...f,"cmdk-group":"",role:"presentation",hidden:y?void 0:!0},n&&r.createElement("div",{ref:g,"cmdk-group-heading":"","aria-hidden":!0,id:b},n),F(t,C=>r.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?b:void 0},r.createElement(fe.Provider,{value:E},C))))}),Se=r.forwardRef((t,o)=>{let{alwaysRender:n,...l}=t,c=r.useRef(null),f=D(d=>!d.search);return!n&&!f?null:r.createElement(I.div,{ref:N([c,o]),...l,"cmdk-separator":"",role:"separator"})}),Ee=r.forwardRef((t,o)=>{let{onValueChange:n,...l}=t,c=t.value!=null,f=Q(),d=D(u=>u.search),v=D(u=>u.value),g=G(),b=r.useMemo(()=>{var y;let u=(y=g.listInnerRef.current)==null?void 0:y.querySelector(`${X}[${T}="${encodeURIComponent(v)}"]`);return u==null?void 0:u.getAttribute("id")},[]);return r.useEffect(()=>{t.value!=null&&f.setState("search",t.value)},[t.value]),r.createElement(I.input,{ref:o,...l,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":g.listId,"aria-labelledby":g.labelId,"aria-activedescendant":b,id:g.inputId,type:"text",value:c?t.value:d,onChange:u=>{c||f.setState("search",u.target.value),n==null||n(u.target.value)}})}),Ce=r.forwardRef((t,o)=>{let{children:n,label:l="Suggestions",...c}=t,f=r.useRef(null),d=r.useRef(null),v=G();return r.useEffect(()=>{if(d.current&&f.current){let g=d.current,b=f.current,u,y=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let E=g.offsetHeight;b.style.setProperty("--cmdk-list-height",E.toFixed(1)+"px")})});return y.observe(g),()=>{cancelAnimationFrame(u),y.unobserve(g)}}},[]),r.createElement(I.div,{ref:N([f,o]),...c,"cmdk-list":"",role:"listbox","aria-label":l,id:v.listId},F(t,g=>r.createElement("div",{ref:N([d,v.listInnerRef]),"cmdk-list-sizer":""},g)))}),xe=r.forwardRef((t,o)=>{let{open:n,onOpenChange:l,overlayClassName:c,contentClassName:f,container:d,...v}=t;return r.createElement(w.Root,{open:n,onOpenChange:l},r.createElement(w.Portal,{container:d},r.createElement(w.Overlay,{"cmdk-overlay":"",className:c}),r.createElement(w.Content,{"aria-label":t.label,"cmdk-dialog":"",className:f},r.createElement(me,{ref:o,...v}))))}),Pe=r.forwardRef((t,o)=>D(l=>l.filtered.count===0)?r.createElement(I.div,{ref:o,...t,"cmdk-empty":"",role:"presentation"}):null),we=r.forwardRef((t,o)=>{let{progress:n,children:l,label:c="Loading...",...f}=t;return r.createElement(I.div,{ref:o,...f,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":c},F(t,d=>r.createElement("div",{"aria-hidden":!0},d)))}),Oe=Object.assign(me,{List:Ce,Item:he,Input:Ee,Group:ye,Separator:Se,Dialog:xe,Empty:Pe,Loading:we});function Ie(t,o){let n=t.nextElementSibling;for(;n;){if(n.matches(o))return n;n=n.nextElementSibling}}function Me(t,o){let n=t.previousElementSibling;for(;n;){if(n.matches(o))return n;n=n.previousElementSibling}}function ve(t){let o=r.useRef(t);return k(()=>{o.current=t}),o}var k=typeof window=="undefined"?r.useEffect:r.useLayoutEffect;function L(t){let o=r.useRef();return o.current===void 0&&(o.current=t()),o}function N(t){return o=>{t.forEach(n=>{typeof n=="function"?n(o):n!=null&&(n.current=o)})}}function D(t){let o=Q(),n=()=>t(o.snapshot());return be(o.subscribe,n)}function ge(t,o,n,l=[]){let c=r.useRef(),f=G();return k(()=>{var g;let d=(()=>{var b;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(b=u.current.textContent)==null?void 0:b.trim():c.current}})(),v=l.map(b=>b.trim());f.value(t,d,v),(g=o.current)==null||g.setAttribute(T,d),c.current=d}),c}var Te=()=>{let[t,o]=r.useState(),n=L(()=>new Map);return k(()=>{n.current.forEach(l=>l()),n.current=new Map},[t]),(l,c)=>{n.current.set(l,c),o({})}};function ke(t){let o=t.type;return typeof o=="function"?o(t.props):"render"in o?o.render(t.props):t}function F({asChild:t,children:o},n){return t&&r.isValidElement(o)?r.cloneElement(ke(o),{ref:o.ref},n(o.props.children)):n(o)}var De={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Oe as Command,xe as CommandDialog,Pe as CommandEmpty,ye as CommandGroup,Ee as CommandInput,he as CommandItem,Ce as CommandList,we as CommandLoading,me as CommandRoot,Se as CommandSeparator,Re as defaultFilter,D as useCommandState};
